# 练习 4: 实现基础工作流

**难度**：⭐⭐ 初级
**预计时间**：25 分钟

## 学习目标

完成这个练习后，你将：

- 理解如何设计 Skill 的工作流
- 知道如何组织多步骤任务
- 能够创建有清晰流程的 Skill

## 前置知识

- 已完成练习 1-3
- 了解基本工具使用

## 任务描述

创建一个名为 `code-review-helper` 的 Skill，帮助用户进行代码审查。

### 工作流程

1. **询问文件**：询问用户要审查哪个文件
2. **读取代码**：读取文件内容
3. **分析代码**：分析代码质量
4. **生成报告**：生成审查报告

## 要求

### 1. 清晰的步骤定义

```markdown
## 工作流程

### 步骤 1: 识别文件
- 询问文件路径
- 验证文件存在

### 步骤 2: 读取代码
- 使用 Read 工具读取文件
- 识别编程语言

### 步骤 3: 分析代码
- 检查代码风格
- 识别潜在问题
- 提供改进建议

### 步骤 4: 生成报告
- 格式化输出
- 包含具体建议
```

### 2. 输出格式

```markdown
# 代码审查报告

**文件**：[文件路径]
**语言**：[编程语言]

## 整体评价

[总体评估，如：代码结构良好，但有一些改进空间]

## 具体建议

### ✅ 做得好的地方

- [优点 1]
- [优点 2]

### ⚠️ 需要改进的地方

- [问题 1]
  - **位置**：[行号或函数名]
  - **建议**：[具体建议]

- [问题 2]
  - **位置**：[行号或函数名]
  - **建议**：[具体建议]

## 总结

[简短总结]
```

### 3. 代码质量检查点

检查以下方面：

- 代码结构和组织
- 命名规范
- 注释和文档
- 错误处理
- 性能考虑
- 安全问题

## 提示

### 提示 1: 渐进式执行

不要一次性完成所有步骤，让用户跟随进度：

```markdown
## 开始代码审查

### 步骤 1/4: 识别文件
请问要审查哪个文件？

[等待用户输入]

### 步骤 2/4: 读取代码
正在读取文件...
[显示读取进度]

### 步骤 3/4: 分析代码
正在分析代码质量...
[显示分析进度]

### 步骤 4/4: 生成报告
生成审查报告...
```

### 提示 2: 识别编程语言

根据文件扩展名识别：

```javascript
{
  '.js': 'JavaScript',
  '.py': 'Python',
  '.java': 'Java',
  '.cpp': 'C++',
  '.go': 'Go'
}
```

### 提示 3: 具体的建议

提供具体而非泛泛的建议：

- ❌ "改进代码风格"
- ✅ "函数名 `getData` 不够具体，建议改为 `fetchUserData`"

### 提示 4: 平衡反馈

既指出问题，也认可优点：

```markdown
## 做得好的地方

- ✅ 函数职责单一，易于理解
- ✅ 有适当的错误处理

## 需要改进的地方

- ⚠️ 变量命名不够描述性
- ⚠️ 缺少函数注释
```

## 示例输出

**用户**：`code-review-helper`

**Assistant**：

```
# 代码审查助手

### 步骤 1/4: 识别文件

请问要审查哪个文件？

[用户输入：src/utils/api.js]

### 步骤 2/4: 读取代码

正在读取 src/utils/api.js...
已读取 150 行代码

### 步骤 3/4: 分析代码

正在分析代码质量...
- 检查代码结构... ✓
- 检查命名规范... ⚠️
- 检查错误处理... ✓
- 检查性能... ✓

### 步骤 4/4: 生成报告

# 代码审查报告

**文件**：src/utils/api.js
**语言**：JavaScript

## 整体评价

代码整体结构良好，有适当的错误处理。但在命名规范和文档方面可以改进。

## 具体建议

### ✅ 做得好的地方

- 函数职责单一，每个函数只做一件事
- 使用 async/await 处理异步操作
- 有适当的错误处理

### ⚠️ 需要改进的地方

- **变量命名**
  - 位置：第 25 行
  - 建议：`d` 改为 `data`，`r` 改为 `response`

- **缺少注释**
  - 位置：`fetchUserData` 函数
  - 建议：添加 JSDoc 注释说明参数和返回值

- **魔法数字**
  - 位置：第 50 行
  - 建议：将 `3000` 提取为常量 `DEFAULT_TIMEOUT`

## 总结

代码质量良好，主要改进空间在于命名规范和添加文档注释。
```

## 验收标准

完成练习后，检查：

- [ ] 有清晰的工作流程定义
- [ ] 每个步骤有明确的目标
- [ ] 输出格式符合要求
- [ ] 包含正反馈和改进建议
- [ ] 建议具体可行
- [ ] 支持多种编程语言

## 参考答案

完成练习后，可以查看 `solutions/beginner/exercise-04.md` 对比参考答案。

## 延伸挑战

- 添加代码复杂度分析
- 集成代码风格检查工具（如 ESLint）
- 生成可执行的修复代码
- 支持批量审查多个文件

## 相关资源

- [工作流设计教程](../../docs/tutorials/tutorial-03-workflow-design.md)
- [code-explainer 示例](../../skills/01-basics/code-explainer/)
